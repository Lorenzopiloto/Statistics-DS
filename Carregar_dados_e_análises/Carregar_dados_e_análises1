import numpy as np
import pandas as pd

import matplotlib.pyplot as plt
%matplotlib inline

import seaborn as sns

CARREGAR DADOS
- ARQUIVOS .CSV
df_dados_paises = pd.read_csv('dados_1997_2011_paises_csv.csv',
                              sep = ';',
                              encoding='latin1',
                              decimal=',')

df_dados_paises.head()

ANÁLISES
- ADICIONAR/MODIFICAR COLUNAS
df_dados_paises['ln_pop'] = df_dados_paises['populacao'].apply(lambda x: np.log(x))

- SELECIONAR COLUNAS
df_dados_paises[['pais', 'ano', 'idh']].head()

- fILTRAR LINHA DE DADOS
df_dados_paises[df_dados_paises['ano'] == 2010].head()

- SUMARIZAR DADOS
df_dados_paises.agg(idh_total_medio = pd.NamedAgg(column = 'idh', aggfunc = sum))

- ORDENAR DADOS 
df_dados_paises.sort_values('ano', ascending=True).head()

- PIVOT: EXTENDER OS DADOS EM CHAVE VALOR
df_dados_paises.pivot(index = 'ano', columns = 'pais', values = 'idh').head()

- MELT: SELECIONAR COLUNAS E AGRUPAR
pd.melt(df_dados_paises, id_vars=['pais', 'ano'], var_name = 'indicadores', value_name = 'indices')

- CONCATENAR VALORES DAS COLUNAS
df_dados_paises['pais'] + '_' + df_dados_paises['ano'].astype(str)

df_dados_paises['pais'].str.cat(df_dados_paises['ano'].astype(str), sep="_")

-GRÁFICOS
- GRÁFICO DE BARRAS
dados_2010 = df_dados_paises[df_dados_paises['ano'] == 2010]

ax = dados_2010.plot.bar(x = 'pais', y = 'corrupcao_indice', legend = None)
plt.xlabel("Países")
plt.ylabel("Índice de corrupção")
plt.title('Corrupção por país')

- GRÁFICO DE LINHAS
dados_brasil = df_dados_paises[df_dados_paises['pais'] == 'Brasil']

ax = dados_brasil.plot.line(x = 'ano', y = 'idh', legend = None)
plt.xlabel("Ano")
plt.ylabel("IDH")
plt.title('IDH Brasil')





